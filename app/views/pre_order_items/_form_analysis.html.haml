= default_resource_form([@pre_order, @pre_order_item], read_only: local_assigns[:readonly], wrapper: :vertical_form) do |f|
  .row.post
    .col-3
      = f.association :sku1, as: :sku_selection, source_url: '/skus', disabled: true
      -#= f.association :sku2, as: :sku_selection, source_url: '/skus'
      = f.input :skuid2
      = f.association :code

    .col-3
      = f.input :orderquant1, disabled: true
      = f.association :purchase_order, as: :sku_po_history_selection, for_sku: :skuid2
      = f.input :preorderurgent, wrapper: :vertical_form
    .col-3
      = f.input :orderpriceper1, disabled: true
      = f.input :orderaupriceper, as: :currency

    .col-3
      = f.input :orderpricetotal1, disabled: true
      = f.input :notes

  .row.post
    .col-6
      .card.card-secondary
        .card-header
          %h4.card-title.w-100 Previous Subsitutions
        .card-body
          %table.table.table-striped.table-compact
            %thead
              %th SKUID
              %th Desc
              %th Cust
              %th
            %tbody
              - @pre_order_item.substitutions.each do |sub|
                %tr
                  %td
                    %a.sub-selector.btn.btn-sm.btn-outline-primary{ data: {skuid: sub.skuid2}} Select
                  %td=sub.sku2.skudesc
                  %td=sub.custname
                  %td
                    = link_to analysis_pre_order_pre_order_item_path(@pre_order, @pre_order_item, skuid: sub.skuid2) do
                      = fa_icon 'book', text: sub.skuid2

    .col-6
      .card.card-secondary
        .card-header
          %h4.card-title.w-100 SKU Order History for #{params[:skuid]}
        .card-body
          = render_datatable PreOrderItemHistoryDatatable.new(skuid: params[:skuid]),
            pagination: true,
            sort:       false,
            entries:    false,
            buttons:    false,
            search:     false

-#  .row.post
-#    .col-12
-#      -# = turbo_frame_tag :po_history do
-#      = render_datatable SkuHistoryDatatable.new(skuid: params[:skuid]),
-#        pagination: true,
-#        sort:       true,
-#        entries:    false,
-#        buttons:    false,
-#        search:     false

  - unless local_assigns[:readonly]
    .row
      = simple_form_submit(f)

- content_for :scripts do
  = javascript_include_tag 'pre_order_item'

  :coffee
    $(document).ready -> new LinkedSkuInputPoSelect('#pre_order_item_skuid2', '#pre_order_item_poid')
